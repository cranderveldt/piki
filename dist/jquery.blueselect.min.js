(function(l){l.fn.blueSelect=function(s){var e=l.extend({icon:"&varr;",skin:"default"},s);return this.each(function(){var s=l(this),t=!1,i='<div class="blsl-container"><div class="blsl-select">',n=s.find("option:selected").text();""===n&&(n=s.find("option:first").text()),i=i+'<div class="blsl-title" data-blsl-default="'+n+'">'+n+"</div>"+'<span class="blsl-icon">'+e.icon+"</span>"+"</div>"+'<div class="blsl-search">'+'<input class="blsl-search-field" type="text" placeholder="Search for options" />'+"</div>"+'<div class="blsl-options">'+"<ul>",s.find('option[disabled!="disabled"]').each(function(){var s=l(this),e="";l.each(this.attributes,function(l,s){var t=s.name,i=s.value;e=e+" data-blsl-"+t+'="'+i+'"'}),i=i+'<li class="blsl-match"'+e+">"+s.text()+"</li>"}),i=i+"</ul>"+"</div>"+"</div>",s.hide().after(i);var a=s.next(),h=function(s){var e=s.find(".blsl-highlight").data("blsl-selected","selected").removeClass("blsl-highlight").siblings().data("blsl-selected","").addClass("blsl-match").end();if(e.length>0)s.find(".blsl-title").text(e.text()),s.find('option[value="'+e.data("blsl-value")+'"]').prop("selected","selected");else{var t=s.find(".blsl-title");console.log("yeah"),t.text("whatever")}l("body").off(),s.find(".blsl-select").show().siblings().hide(),s.find(".blsl-search-field").val("")},o=function(l){var s=l.find(".blsl-highlight");if(s.length>0){console.log("current > 0");var e=s.next(".blsl-match");e.length>0&&(console.log("next > 0"),s.removeClass("blsl-highlight"),e.addClass("blsl-highlight"))}else console.log("current less than 0"),l.find(".blsl-match").length>0&&(console.log("match > 0"),l.find(".blsl-match:first").addClass("blsl-highlight"))},c=function(l){var s=l.find(".blsl-highlight");if(s.length>0){console.log("current > 0");var e=s.prev(".blsl-match");e.length>0&&(console.log("prev > 0"),s.removeClass("blsl-highlight").prev(".blsl-match").addClass("blsl-highlight"))}else console.log("current less than 0"),l.find(".blsl-match").length>0&&(console.log("match > 0"),l.find(".blsl-match:first").addClass("blsl-highlight"))};l("html").on("keypress",".blsl-search-field",function(l){13===l.keyCode&&l.preventDefault()}),l("html").on("keyup",".blsl-search-field",function(s){if(!t){t=!0;var e=l(this).parent().parent(),i=e.find(".blsl-options ul li");13===s.keyCode&&h(e),38===s.keyCode&&c(e),40===s.keyCode&&o(e);var n=l(this).val().toLowerCase();i.each(function(){var s=l(this).text().toLowerCase();-1===s.indexOf(n)?l(this).removeClass("blsl-match"):l(this).addClass("blsl-match")}),e.find(".blsl-match:first").addClass("blsl-highlight").siblings().removeClass("blsl-highlight"),t=!1}}),l("html").on("click",".blsl-match",function(){l(this).addClass("blsl-highlight").siblings().removeClass("blsl-highlight"),h(l(this).parent().parent().parent())}),l("html").on("click",".blsl-select",function(){l(this).hide().siblings().show().end().parent().find(".blsl-search-field").focus(),l("body").on("click",function(s){var e=!1;l(s.target).parents().each(function(){l(this).hasClass("blsl-container")&&(e=!0)}),e||(l("body").off(),a.find(".blsl-select").show().siblings().hide())})})})}})(jQuery);