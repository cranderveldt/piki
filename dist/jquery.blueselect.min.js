(function(l){l.fn.blueSelect=function(s){var e=l.extend({icon:"&varr;",skin:"default"},s);return this.each(function(){var s=l(this),t='<div class="blsl-container"><div class="blsl-select">',i=s.find("option:selected").text();""===i&&(i=s.find("option:first").text()),t=t+'<div class="blsl-title" data-blsl-default="'+i+'">'+i+"</div>"+'<span class="blsl-icon">'+e.icon+"</span>"+"</div>"+'<div class="blsl-search">'+'<input class="blsl-search-field" type="text" placeholder="Search for options" />'+"</div>"+'<div class="blsl-options">'+"<ul>",s.find('option[disabled!="disabled"]').each(function(){var s=l(this),e="";l.each(this.attributes,function(l,s){var t=s.name,i=s.value;e=e+" data-blsl-"+t+'="'+i+'"'}),t=t+'<li class="blsl-match"'+e+">"+s.text()+"</li>"}),t=t+"</ul>"+"</div>"+"</div>",s.hide().after(t);var a=s.next(),n=function(s){var e=s.find(".blsl-highlight").data("blsl-selected","selected").removeClass("blsl-highlight").siblings().data("blsl-selected","").addClass("blsl-match").end();if(e.length>0)s.find(".blsl-title").text(e.text()),s.find('option[value="'+e.data("blsl-value")+'"]').prop("selected","selected");else{var t=s.find(".blsl-title");t.text(t.data("blsl-default"))}l("body").off(),s.find(".blsl-select").show().siblings().hide(),s.find(".blsl-search-field").val("")},h=function(l){var s=l.find(".blsl-highlight");if(s.length>0){var e=s.next(".blsl-match");e.length>0&&(s.removeClass("blsl-highlight").next(".blsl-match").addClass("blsl-highlight"),e.scrollTop(1e3))}else l.find(".blsl-match").length>0&&l.find(".blsl-match:first").addClass("blsl-highlight")},d=function(l){var s=l.find(".blsl-highlight");if(s.length>0){var e=s.prev(".blsl-match");e.length>0&&s.removeClass("blsl-highlight").prev(".blsl-match").addClass("blsl-highlight")}else l.find(".blsl-match").length>0&&l.find(".blsl-match:first").addClass("blsl-highlight")};a.on("keypress",".blsl-search-field",function(l){(13===l.keyCode||38===l.keyCode||40===l.keyCode)&&l.preventDefault()}),a.on("keyup",".blsl-search-field",function(s){var e=!1,t=l(this).parent().parent(),i=t.find(".blsl-options ul li");13===s.keyCode&&n(t);var a=l(this).val().toLowerCase();i.each(function(){var s=l(this).text().toLowerCase();-1===s.indexOf(a)?l(this).removeClass("blsl-match"):l(this).addClass("blsl-match")}),38===s.keyCode&&(e=!0,d(t)),40===s.keyCode&&(e=!0,h(t)),e||t.find(".blsl-match:first").addClass("blsl-highlight").siblings().removeClass("blsl-highlight")}),a.on("click",".blsl-match",function(){l(this).addClass("blsl-highlight").siblings().removeClass("blsl-highlight"),n(l(this).parent().parent().parent())}),a.on("click",".blsl-select",function(){l(this).hide().siblings().show().end().parent().find(".blsl-search-field").focus(),l("body").on("click",function(s){var e=!1;l(s.target).parents().each(function(){l(this).hasClass("blsl-container")&&(e=!0)}),e||(l("body").off(),a.find(".blsl-select").show().siblings().hide())})})})}})(jQuery);